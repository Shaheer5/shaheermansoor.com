---
title: 'The Best Guide to PWA with NextJS'
date: '2024-6-7'
lastmod: '2024-6-7'
tags: ['next-js', 'guide', 'feature']
draft: false
summary: 'A Progressive Web App (PWA) is a web application that offers a native app-like experience using web technologies like HTML, CSS, and JavaScript.'
images:
  [
    '/static/images/blog-images/simicart.webp',
    '/static/images/blog-images/pwa-warning.webp',
    '/static/images/blog-images/pwa-created.webp',
  ]
authors: ['default']
---

# Creating PWA With Next.js

<TOCInline toc={props.toc} asDisclosure exclude={'Creating PWA With Next.js'} />

## What is PWA?

A Progressive Web App (PWA) is a web application that offers a native app-like experience using web technologies like HTML, CSS, and JavaScript. Key features include:

- **Progressive**: Works on any browser and device.
- **Installable**: Can be added to the home screen.
- **Offline Capable**: Functions without a network connection.
- **Responsive**: Adapts to different screen sizes.
- **App-like**: Mimics the look and feel of native apps.
- **Secure**: Served via HTTPS.
- **Discoverable**: Easily found by search engines.
- **Re-engageable**: Supports push notifications.
- **Linkable**: Shareable via URL.

## Setting up in NextJS App

### Creating a Next.js app

```ts:>_terminal
npx create-next-app next-pwa-test
```

When the app is created, install the required pwa **dependency**.

```ts:>_terminal
// if using npm
npm i next-pwa
// if using yarn
yarn add next-pwa
```

## Generating a manifest

[Simicart](https://www.simicart.com/manifest-generator.html) is a great online tool for generating the manifest. Follow the link, fill up the input fields and provide site logo, and then hit generate.

Simicart will generate a zip file containing images of 4 sizes: **192x192, 256x256, 384x384 & 512x512** and a `manifest.webmanifest` change its name to `manifest.json`.

extract the zipfile & paste it into public folder of the App.

![Simicart Guide](/static/images/blog-images/simicart.webp)

`manifest.json` file generated by [Simicart](https://www.simicart.com/manifest-generator.html).

```ts:manifest.json
{
  "theme_color" : "#f69435",
  "background_color" : "#f69435",
  "display" : "standalone",
  "scope" : "/",
  "start_url" : "/",
  "description" : "hi mom",
  "name" : "NextJS PWA",
  "short_name" : "PWA",
  "icons": [
    {
      "src": "/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icon-256x256.png",
      "sizes": "256x256",
      "type": "image/png"
    },
    {
      "src": "/icon-384x384.png",
      "sizes": "384x384",
      "type": "image/png"
    },
    {
      "src": "/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}

```

## Creating **\_document.js**

Create `_document.js` in the pages folder and add the following piece of code.

```ts:_document.tsx
  import Document, { Html, Head, Main, NextScript } from 'next/document'

  class MyDocument extends Document {
    render() {
      return (
        <Html>
          <Head>
            <link rel="manifest" href="/static/favicons/manifest.json" />
            <link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png" />
            <meta name="theme-color" content="#fff" />
          </Head>
          <body>
            <Main />
            <NextScript />
          </body>
        </Html>
      )
    }
  }

  export default MyDocument

```

## Configuring PWA in Next config

Now, add some data for configuring the PWA, add the snippet below in `next.config.js`.

```ts:next.config.js
  const withPWA = require("next-pwa");

  module.exports = withPWA({
    pwa: {
      dest: "public",
      register: true,
      skipWaiting: true,
    },
  });
```

This is just a simple configuration. **BUT** if you have a little complex app you can follow this pattern:

```ts:next.config.js
  const withPWA = require('next-pwa')({
    dest: 'public',
    register: true,
    skipWaiting: true,
  })

  // Your Content Security Headers Here
  //-------------------------
  //-----------------

  /**
  * @type {import('next').NextConfig}
  **/
  const nextConfig = {
    reactStrictMode: true,
    pageExtensions: ['ts', 'tsx', 'js', 'jsx', 'md', 'mdx'],
    eslint: {
      dirs: ['app', 'components', 'layouts', 'scripts'],
    },
    images: {
      remotePatterns: [
        {
          protocol: 'https',
          hostname: 'picsum.photos',
        },
      ],
    },
    async headers() {
      return [
        {
          source: '/(.*)',
          headers: [...securityHeaders],
        },
      ]
    },
    webpack: (config, options) => {
      config.module.rules.push({
        test: /\.svg$/,
        use: ['@svgr/webpack'],
      })
      return config
    },
  }

  // Here you can do module.exports
  module.exports = withPWA(withContentlayer(withBundleAnalyzer(nextConfig)))
```

ðŸ¥³ Congrats Your Progressive Web App is created.

![PWA Created](/static/images/blog-images/pwa-created.webp)

## Protips :)

### Adding the auto-generated files to `.gitignore`.

Before Building the app, add these in your `.gitignore` file, because these files are updated constantly,

```ts:.gitignore
  # PWA files
  **/public/sw.js
  **/public/workbox-*.js
  **/public/worker-*.js
  **/public/sw.js.map
  **/public/workbox-*.js.map
  **/public/worker-*.js.map
```

These are not needed in your GitHub. So, do the following to remove them from production.

- Delete `sw.js`, `sw.js.map`, `workbox-\***\*.js` and `workbox-\*\***.js.map`.

### Disabling PWA in development

In development, you can disable PWA because it gives a lot of console messages.

![PWA Warning](/static/images/blog-images/pwa-warning.webp)

```ts:next.config.js
  const withPWA = require("next-pwa");

  module.exports = withPWA({
    pwa: {
      dest: "public",
      register: true,
      skipWaiting: true,
      // add the line below
      disable: process.env.NODE_ENV === "development",
    },
  });
```

Thanks you so much for reading {'<3'}
